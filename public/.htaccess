# --- MINIMALNY FRONT CONTROLLER + HTTPS ---
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Jeśli aplikacja jest w podkatalogu, zmień na np. /app/
    RewriteBase /

    # --- WYMUSZENIE HTTPS (tu wstawiamy) ---
    # Przekieruj tylko gdy NIE jest HTTPS i jednocześnie X-Forwarded-Proto != https
    RewriteCond %{HTTPS} !=on
    RewriteCond %{HTTP:X-Forwarded-Proto} !https [NC]
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

    # Istniejące pliki/katalogi serwuj normalnie
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # Reszta do index.php
    RewriteRule ^ index.php [QSA,L]
</IfModule>

# Awaryjny fallback, gdy brak mod_rewrite
<IfModule !mod_rewrite.c>
    # Jeśli .htaccess leży w tym samym katalogu co index.php i to jest root:
    FallbackResource /index.php
    # Jeśli to podkatalog, użyj np.: FallbackResource /app/index.php
</IfModule>
